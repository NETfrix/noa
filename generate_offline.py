#!/usr/bin/env python3
"""
Generate daily literary content for Tel Aviv Libraries Facebook page.
Uses a curated database of literary events - no API required.

Usage: python generate_offline.py [MM-DD]
"""

import json
import sys
import os
from datetime import date, datetime

SCRIPT_DIR = os.path.dirname(os.path.abspath(__file__))
CONTENT_DIR = os.path.join(SCRIPT_DIR, "content")

# Hebrew month names for rough Hebrew date display
HEBREW_MONTHS_2026 = {
    "01-01": "י״א טבת תשפ״ו",
    "01-15": "כ״ה טבת תשפ״ו",
    "02-01": "י״ב שבט תשפ״ו",
    "02-15": "כ״ו שבט תשפ״ו",
    "02-27": "ט׳ אדר תשפ״ו",
    "02-28": "י׳ אדר תשפ״ו",
    "03-01": "י״א אדר תשפ״ו",
    "03-15": "כ״ה אדר תשפ״ו",
    "04-01": "י״ב ניסן תשפ״ו",
    "04-15": "כ״ו ניסן תשפ״ו",
    "05-01": "י״ג אייר תשפ״ו",
    "05-15": "כ״ז אייר תשפ״ו",
    "06-01": "י״ד סיוון תשפ״ו",
    "06-15": "כ״ח סיוון תשפ״ו",
    "07-01": "י״ד תמוז תשפ״ו",
    "07-15": "כ״ח תמוז תשפ״ו",
    "08-01": "ט״ו אב תשפ״ו",
    "08-15": "כ״ט אב תשפ״ו",
    "09-01": "ט״ז אלול תשפ״ו",
    "09-15": "א׳ תשרי תשפ״ז",
    "10-01": "י״ז תשרי תשפ״ז",
    "10-15": "א׳ חשוון תשפ״ז",
    "11-01": "י״ח חשוון תשפ״ז",
    "11-15": "ב׳ כסלו תשפ״ז",
    "12-01": "י״ח כסלו תשפ״ז",
    "12-15": "ב׳ טבת תשפ״ז",
}

def get_approximate_hebrew_date(mm_dd):
    """Return closest known Hebrew date or empty string."""
    if mm_dd in HEBREW_MONTHS_2026:
        return HEBREW_MONTHS_2026[mm_dd]
    # Find closest earlier date
    candidates = sorted(HEBREW_MONTHS_2026.keys())
    best = ""
    for c in candidates:
        if c <= mm_dd:
            best = HEBREW_MONTHS_2026[c]
    return best if best else ""

# ═══════════════════════════════════════════════════════════════
#  LITERARY EVENTS DATABASE — day → list of events
#  Each event: (title, description, type, year)
# ═══════════════════════════════════════════════════════════════
EVENTS = {
    "01-01": [
        ("יום הולדתו של ח.נ. ביאליק", "חיים נחמן ביאליק, המשורר הלאומי, נולד ב-1873 בראדי שבאוקראינה. יצירותיו עיצבו את השירה העברית המודרנית.", "israeli", 1873),
        ("יום הולדתו של ג׳.ד. סלינג׳ר", "ג׳רום דיוויד סלינג׳ר, מחבר 'השומר בשדה השיפון', נולד ב-1919 בניו יורק.", "international", 1919),
        ("יום הולדתו של א.מ. פורסטר", "הסופר הבריטי א.מ. פורסטר, מחבר 'מעבר להודו' ו'חדר עם נוף', נולד ב-1879.", "international", 1879),
    ],
    "01-02": [
        ("יום הולדתו של יצחק אסימוב", "סופר המדע הבדיוני יצחק אסימוב נולד ב-1920. ספריו כמו סדרת 'הבסיס' ו'אני, רובוט' הם אבני דרך בז׳אנר.", "international", 1920),
    ],
    "01-03": [
        ("יום הולדתו של י.ר.ר. טולקין", "ג׳ון רונלד רואל טולקין, מחבר 'שר הטבעות' ו'ההוביט', נולד ב-1892 בדרום אפריקה.", "international", 1892),
    ],
    "01-04": [
        ("יום הולדתו של יעקב שבתאי", "הסופר הישראלי יעקב שבתאי, מחבר 'זיכרון דברים' ו'סוף דבר', נולד ב-1934 בתל אביב.", "israeli", 1934),
    ],
    "01-05": [
        ("פטירתו של אומברטו אקו", "הסופר והפילוסוף האיטלקי אומברטו אקו, מחבר 'שם הוורד', נפטר בגיל 84.", "international", 2016),
    ],
    "01-06": [
        ("יום הולדתו של חליל ג׳ובראן", "המשורר והסופר הלבנוני חליל ג׳ובראן, מחבר 'הנביא', נולד ב-1883.", "international", 1883),
    ],
    "01-07": [
        ("יום הולדתו של ג׳רלד דארל", "הסופר והטבען הבריטי ג׳רלד דארל, מחבר 'משפחתי ובעלי חיים אחרים', נולד ב-1925.", "international", 1925),
    ],
    "01-08": [
        ("פטירתו של גליל גלילי (גליליאו)", "גלילאו גלילי, שכתיבתו המדעית שינתה את העולם, נפטר ב-1642.", "international", 1642),
    ],
    "01-09": [
        ("יום הולדתה של סימון דה בובואר", "הסופרת והפילוסופית הצרפתייה סימון דה בובואר, מחברת 'המין השני', נולדה ב-1908.", "international", 1908),
    ],
    "01-10": [
        ("פטירתה של אגתה כריסטי", "מלכת הבלשים אגתה כריסטי נפטרה ב-1976. ספריה נמכרו ביותר משני מיליארד עותקים ותורגמו ליותר מ-100 שפות.", "international", 1976),
    ],
    "01-11": [
        ("יום הולדתו של הרוקי מוראקמי", "הסופר היפני הרוקי מוראקמי, מחבר 'יער נורווגי' ו'קפקא על החוף', נולד ב-1949.", "international", 1949),
    ],
    "01-12": [
        ("יום הולדתו של ג׳ק לונדון", "הסופר האמריקאי ג׳ק לונדון, מחבר 'קריאת הטבע' ו'ניב הלבן', נולד ב-1876.", "international", 1876),
    ],
    "01-13": [
        ("פטירתו של ג׳יימס ג׳ויס", "הסופר האירי ג׳יימס ג׳ויס, מחבר 'יוליסס' ו'דיוקנו של האמן כאיש צעיר', נפטר ב-1941.", "international", 1941),
    ],
    "01-14": [
        ("יום הולדתו של יהודה עמיחי", "המשורר הישראלי יהודה עמיחי, מגדולי המשוררים העבריים, נולד ב-1924 בוירצבורג, גרמניה. שירתו מהווה אבן דרך בשירה העברית.", "israeli", 1924),
    ],
    "01-15": [
        ("יום הולדתו של מולייר", "המחזאי הצרפתי ז׳אן-בטיסט פוקלן (מולייר), מגדולי כותבי הקומדיה בהיסטוריה, נולד ב-1622.", "international", 1622),
    ],
    "01-16": [
        ("פטירתה של אגתה כריסטי (נוסף)", "הסופרת הבריטית, בעלת השיא בזכויות יוצרים בתחום הבלשים.", "international", 1976),
    ],
    "01-17": [
        ("יום הולדתו של חנוך לוין", "המחזאי והמשורר הישראלי חנוך לוין נולד ב-1943 בתל אביב. מחזותיו כמו 'יאסון' ו'המטבח של הלנה' הם מיצירות המופת של התיאטרון הישראלי.", "israeli", 1943),
    ],
    "01-18": [
        ("יום הולדתו של א.א. מילן", "הסופר הבריטי אלן אלכסנדר מילן, יוצר 'פו הדב', נולד ב-1882.", "international", 1882),
    ],
    "01-19": [
        ("יום הולדתו של אדגר אלן פו", "הסופר והמשורר האמריקאי אדגר אלן פו, אבי סיפור הבלשים, נולד ב-1809.", "international", 1809),
    ],
    "01-20": [
        ("פטירתו של ג׳ון ראסקין", "המבקר, הסופר והפילוסוף הבריטי ג׳ון ראסקין נפטר ב-1900.", "international", 1900),
    ],
    "01-21": [
        ("פטירתו של ג׳ורג׳ אורוול", "הסופר הבריטי ג׳ורג׳ אורוול, מחבר '1984' ו'חוות החיות', נפטר ב-1950.", "international", 1950),
    ],
    "01-22": [
        ("יום הולדתו של לורד ביירון", "המשורר הרומנטי הבריטי לורד ביירון נולד ב-1788. שירתו השפיעה על הספרות האירופית כולה.", "international", 1788),
    ],
    "01-23": [
        ("יום הולדתו של סטנדל", "הסופר הצרפתי סטנדל (מארי-אנרי בייל), מחבר 'האדום והשחור', נולד ב-1783.", "international", 1783),
    ],
    "01-24": [
        ("פטירתו של ווינסטון צ׳רצ׳יל", "מדינאי ובעל פרס נובל לספרות, צ׳רצ׳יל נפטר ב-1965. זוכה נובל לספרות ב-1953 על כתיבתו ההיסטורית.", "international", 1965),
    ],
    "01-25": [
        ("יום הולדתה של וירג׳יניה וולף", "הסופרת הבריטית וירג׳יניה וולף, מחברת 'גב׳ דאלוויי' ו'למגדלור', נולדה ב-1882.", "international", 1882),
    ],
    "01-26": [
        ("יום הולדתו של אהרן אפלפלד", "הסופר הישראלי אהרן אפלפלד, ניצול שואה ומגדולי הסופרים העבריים, נולד ב-1932 בצ׳רנוביץ. זוכה פרס ישראל לספרות.", "israeli", 1932),
    ],
    "01-27": [
        ("יום הולדתו של לואיס קרול", "הסופר הבריטי לואיס קרול, מחבר 'הרפתקאות אליס בארץ הפלאות', נולד ב-1832.", "international", 1832),
        ("יום השואה הבינלאומי", "יום הזיכרון הבינלאומי לקרבנות השואה. ביום זה שוחרר מחנה ההשמדה אושוויץ ב-1945.", "israeli", 1945),
    ],
    "01-28": [
        ("פטירתו של ויליאם בטלר ייטס", "המשורר האירי ו.ב. ייטס, זוכה פרס נובל לספרות, נפטר ב-1939.", "international", 1939),
    ],
    "01-29": [
        ("יום הולדתו של אנטון צ׳כוב", "הסופר והמחזאי הרוסי אנטון צ׳כוב, ממחדשי הסיפור הקצר והדרמה, נולד ב-1860.", "international", 1860),
    ],
    "01-30": [
        ("פטירתו של מהטמה גנדי", "גנדי, מנהיג שכתיבתו וחשיבתו שינו את העולם, נרצח ב-1948.", "international", 1948),
    ],
    "01-31": [
        ("יום הולדתה של טוני מוריסון (לקראת)", "הסופרת האפרו-אמריקאית טוני מוריסון, זוכת פרס נובל לספרות, נולדה ב-18 בפברואר 1931.", "international", 1931),
    ],
    "02-01": [
        ("יום הולדתו של שמואל יוסף עגנון — חודש הולדתו", "ש״י עגנון, הסופר הישראלי הראשון שזכה בפרס נובל לספרות (1966), נולד ב-17 באוגוסט 1888 בבוצ׳אץ׳.", "israeli", 1888),
    ],
    "02-02": [
        ("יום הולדתו של ג׳יימס ג׳ויס", "הסופר האירי ג׳יימס ג׳ויס, מחבר 'יוליסס', נולד ב-1882 בדבלין.", "international", 1882),
    ],
    "02-03": [
        ("פטירתו של יוהאן גוטנברג", "ממציא הדפוס במערב, יוהאן גוטנברג, נפטר ב-1468. המצאתו שינתה את עולם הספרות לנצח.", "international", 1468),
    ],
    "02-04": [
        ("פטירתו של בוריס פסטרנק (חודש)", "הסופר הרוסי בוריס פסטרנק, מחבר 'דוקטור ז׳יוואגו', נפטר ב-30 במאי 1960.", "international", 1960),
    ],
    "02-05": [
        ("יום הולדתו של וויליאם ס. בארוז", "הסופר האמריקאי וויליאם ס. בארוז, מדמויות המפתח של דור ה-Beat, נולד ב-1914.", "international", 1914),
    ],
    "02-06": [
        ("פטירתה של סילביה פלאת׳ (חודש)", "המשוררת האמריקאית סילביה פלאת׳, מחברת 'הפעמון הזכוכי', נפטרה ב-11 בפברואר 1963.", "international", 1963),
    ],
    "02-07": [
        ("יום הולדתו של צ׳ארלס דיקנס", "הסופר הבריטי צ׳ארלס דיקנס, מגדולי הסופרים בשפה האנגלית, נולד ב-1812. יצירותיו כמו 'אוליבר טוויסט' ו'סיפור שני ערים' הן קלאסיקות.", "international", 1812),
    ],
    "02-08": [
        ("יום הולדתו של ז׳ול ורן", "הסופר הצרפתי ז׳ול ורן, אבי המדע הבדיוני, נולד ב-1828. ספריו כמו 'עשרים אלף מילין תחת המים' ו'מסע אל מרכז כדור הארץ' היו חלוציים.", "international", 1828),
    ],
    "02-09": [
        ("פטירתו של פיודור דוסטויבסקי", "הסופר הרוסי הגדול דוסטויבסקי, מחבר 'האחים קרמזוב' ו'פשע ועונש', נפטר ב-1881.", "international", 1881),
    ],
    "02-10": [
        ("יום הולדתו של ברטולט ברכט", "המחזאי והמשורר הגרמני ברטולט ברכט, מחדש התיאטרון המודרני, נולד ב-1898.", "international", 1898),
        ("פטירתו של אלכסנדר פושקין", "המשורר הרוסי הגדול אלכסנדר פושקין נפטר ב-1837 בעקבות דו-קרב.", "international", 1837),
    ],
    "02-11": [
        ("פטירתה של סילביה פלאת׳", "המשוררת האמריקאית סילביה פלאת׳, מחברת 'הפעמון הזכוכי' ו'אריאל', נפטרה ב-1963 בלונדון.", "international", 1963),
    ],
    "02-12": [
        ("יום הולדתו של אברהם לינקולן", "הנשיא ה-16 של ארה״ב, שנאומיו וכתיבתו נחשבים לקלאסיקות ספרותיות, נולד ב-1809.", "international", 1809),
    ],
    "02-13": [
        ("פטירתו של ריצ׳רד פיינמן", "הפיזיקאי וזוכה פרס נובל ריצ׳רד פיינמן, שספריו הפופולריים הפכו לרבי-מכר, נפטר ב-1988.", "international", 1988),
    ],
    "02-14": [
        ("יום הוולנטיין — יום הספר והאהבה", "יום בינלאומי חשוב לציון הקשר בין אהבה וספרות. הזדמנות להמליץ על ספרי אהבה מהספרות העברית והעולמית.", "international", 0),
    ],
    "02-15": [
        ("יום הולדתו של גלילאו גלילי", "גלילאו, שכתיבתו המדעית שינתה את ההיסטוריה, נולד ב-1564.", "international", 1564),
    ],
    "02-16": [
        ("פטירתו של דוד פוגל", "המשורר והסופר העברי דוד פוגל נספה בשואה ב-1944. שירתו החדשנית השפיעה על השירה העברית המודרנית.", "israeli", 1944),
    ],
    "02-17": [
        ("פטירתו של מולייר", "המחזאי הצרפתי הגדול מולייר נפטר ב-1673 על הבמה, במהלך הצגת מחזהו 'החולה המדומה'.", "international", 1673),
    ],
    "02-18": [
        ("יום הולדתה של טוני מוריסון", "הסופרת האפרו-אמריקאית טוני מוריסון, זוכת פרס נובל לספרות (1993), נולדה ב-1931. ספריה 'אהובה' ו'שיר שלמה' הם יצירות מופת.", "international", 1931),
    ],
    "02-19": [
        ("פטירתו של אומברטו אקו", "הסופר והפילוסוף האיטלקי אומברטו אקו, מחבר 'שם הוורד' ו'מטוטלת פוקו', נפטר ב-2016.", "international", 2016),
    ],
    "02-20": [
        ("פטירתו של הנטר ס. תומפסון", "העיתונאי והסופר האמריקאי הנטר ס. תומפסון, מייסד 'העיתונות הגונזו', נפטר ב-2005.", "international", 2005),
    ],
    "02-21": [
        ("יום השפה האם הבינלאומי", "יום האו״ם לשפת האם. הזדמנות לציין את חשיבות השפה העברית ואת תחייתה.", "israeli", 0),
    ],
    "02-22": [
        ("יום הולדתו של שמואל הנגיד", "שמואל הנגיד, משורר ומדינאי יהודי מימי הביניים בספרד, מגדולי משוררי תור הזהב.", "israeli", 993),
    ],
    "02-23": [
        ("יום הולדתו של סמואל פפיס", "סמואל פפיס, בעל היומן המפורסם ביותר בשפה האנגלית, נולד ב-1633.", "international", 1633),
    ],
    "02-24": [
        ("יום הולדתו של וילהלם גרים", "וילהלם גרים, אחד מהאחים גרים אוספי האגדות, נולד ב-1786.", "international", 1786),
    ],
    "02-25": [
        ("יום הולדתו של אנתוני בורגס", "הסופר הבריטי אנתוני בורגס, מחבר 'תפוז מכני', נולד ב-1917.", "international", 1917),
    ],
    "02-26": [
        ("יום הולדתו של ויקטור הוגו", "הסופר הצרפתי ויקטור הוגו, מחבר 'עלובי החיים' ו'קוסימודו — גיבן מנוטרדאם', נולד ב-1802.", "international", 1802),
    ],
    "02-27": [
        ("יום הולדתו של הנרי וודסוורת׳ לונגפלו", "המשורר האמריקאי לונגפלו נולד ב-1807 בפורטלנד, מיין. מיצירותיו: 'שירת היאווטה' ו'פול ריוויר רוכב'.", "international", 1807),
        ("יום הולדתו של ג׳ון סטיינבק", "הסופר האמריקאי זוכה פרס נובל נולד ב-1902. ידוע בספריו 'ענבי זעם', 'של עכברים ואנשים' ו'מזרח עדן'.", "international", 1902),
        ("יום הולדתו של אירווין שו", "הסופר והמחזאי האמריקאי נולד ב-1913. ספרו 'הצעירים האריות' תורגם לעברית ונקרא רבות בישראל.", "international", 1913),
        ("יום הולדתו של לורנס דארל", "הסופר הבריטי נולד ב-1912. ידוע בסדרת 'רביעיית אלכסנדריה', יצירת מופת מודרנית.", "international", 1912),
    ],
    "02-28": [
        ("יום הולדתו של מישל דה מונטן", "הפילוסוף והסופר הצרפתי מונטן, מייסד ז׳אנר המסה, נולד ב-1533.", "international", 1533),
    ],
    "03-01": [
        ("יום הולדתו של שלום עליכם (חודש)", "שלום עליכם (שלום רבינוביץ׳), מגדולי סופרי היידיש, נולד ב-2 במרץ 1859 באוקראינה.", "israeli", 1859),
    ],
    "03-02": [
        ("יום הולדתו של שלום עליכם", "שלום עליכם (שלום רבינוביץ׳), מגדולי סופרי היידיש, נולד ב-1859. יצירתו 'טוביה החולב' הפכה לבסיס למחזמר 'כנר על הגג'.", "israeli", 1859),
        ("יום הולדתו של ד״ר סוס", "תאודור סוס גייזל (ד״ר סוס), סופר ומאייר ספרי ילדים אהוב, נולד ב-1904.", "international", 1904),
    ],
    "03-03": [
        ("פטירתו של נתן זך", "המשורר הישראלי נתן זך, ממובילי 'הגל החדש' בשירה העברית, נפטר ב-2020. שירתו חוללה מהפכה בשירה הישראלית.", "israeli", 2020),
    ],
    "03-04": [
        ("יום הולדתו של חיים באר", "הסופר הישראלי חיים באר, מחבר 'את הגמל ראיתי' ו'חבלי', נולד ב-1945.", "israeli", 1945),
    ],
    "03-05": [
        ("פטירתו של ניקולאי גוגול", "הסופר הרוסי-אוקראיני ניקולאי גוגול, מחבר 'נפשות מתות' ו'המעיל', נפטר ב-1852.", "international", 1852),
    ],
    "03-06": [
        ("יום הולדתו של גבריאל גרסיה מארקס", "הסופר הקולומביאני, זוכה פרס נובל ואבי הריאליזם המאגי, נולד ב-1927. ספרו 'מאה שנות בדידות' מהחשובים בספרות העולמית.", "international", 1927),
    ],
    "03-07": [
        ("פטירתו של אריסטו", "הפילוסוף היווני הקדום, שכתיבתו על פואטיקה עיצבה את תורת הספרות, נפטר ב-322 לפנה״ס.", "international", -322),
    ],
    "03-08": [
        ("יום האישה הבינלאומי", "הזדמנות לציין סופרות ישראליות ובינלאומיות: דבורה בארון, לאה גולדברג, אמליה כהנא-כרמון ועוד.", "israeli", 0),
    ],
    "03-09": [
        ("פטירתו של חיים הזז", "הסופר הישראלי חיים הזז, זוכה פרס ישראל לספרות, נפטר ב-1973. ידוע ביצירותיו על חיי היהודים בתימן ובגולה.", "israeli", 1973),
    ],
    "03-10": [
        ("פטירתה של רחל המשוררת", "רחל (רחל בלובשטיין), מגדולות המשוררות העבריות, נפטרה ב-1931 בתל אביב. שיריה הקצרים והמרגשים הפכו חלק מהתרבות הישראלית.", "israeli", 1931),
    ],
    "03-11": [
        ("יום הולדתו של דגלס אדמס", "הסופר הבריטי דגלס אדמס, מחבר 'מדריך הטרמפיסט לגלקסיה', נולד ב-1952.", "international", 1952),
    ],
    "03-12": [
        ("יום הולדתו של ג׳ק קרואק", "הסופר האמריקאי ג׳ק קרואק, מחבר 'על הדרך' ומדמויות המפתח של דור ה-Beat, נולד ב-1922.", "international", 1922),
    ],
    "03-13": [
        ("יום הולדתה של דיאנה ווין ג׳ונס", "סופרת הפנטזיה הבריטית, מחברת 'הטירה הנודדת של האול', נולדה ב-1934.", "international", 1934),
    ],
    "03-14": [
        ("יום הולדתו של אלברט איינשטיין", "הפיזיקאי שכתיבתו ורעיונותיו שינו את המדע. ספריו ומכתביו נותרים רבי-מכר. נולד ב-1879.", "international", 1879),
    ],
    "03-15": [
        ("רצח יוליוס קיסר", "ב-44 לפנה״ס נרצח יוליוס קיסר. האירוע הונצח ביצירתו של שייקספיר 'יוליוס קיסר'.", "international", -44),
    ],
    "03-16": [
        ("פטירתו של עגנון — חודש פטירתו", "ש״י עגנון, זוכה פרס נובל לספרות, נפטר ב-17 בפברואר 1970 בירושלים.", "israeli", 1970),
    ],
    "03-17": [
        ("פטירתו של מרקוס אורליוס", "הקיסר הרומי והפילוסוף הסטואי מרקוס אורליוס, מחבר 'הגיונות', נפטר ב-180.", "international", 180),
    ],
    "03-18": [
        ("יום הולדתו של ג׳ון אפדייק", "הסופר האמריקאי ג׳ון אפדייק, מחבר סדרת 'ארנב', נולד ב-1932.", "international", 1932),
    ],
    "03-19": [
        ("יום הולדתו של פיליפ רות׳", "הסופר האמריקאי-יהודי פיליפ רות׳, מחבר 'קומפליין של פורטנוי' ו'פסטורלה אמריקאית', נולד ב-1933.", "international", 1933),
    ],
    "03-20": [
        ("יום הולדתו של הנריק איבסן", "המחזאי הנורווגי הנריק איבסן, אבי הדרמה המודרנית, נולד ב-1828. מחזותיו כמו 'בית בובות' שינו את התיאטרון.", "international", 1828),
    ],
    "03-21": [
        ("יום השירה העולמי", "יום השירה העולמי של אונסק״ו. הזדמנות מיוחדת לחגוג את השירה העברית והעולמית.", "israeli", 0),
        ("יום הולדתה של רוזריו קאסטיאנוס", "המשוררת המקסיקנית, מדמויות המפתח בספרות אמריקה הלטינית, נולדה ב-1925.", "international", 1925),
    ],
    "03-22": [
        ("יום הולדתו של לואי לאמור", "סופר המערבונים האמריקאי הפורה לואי לאמור נולד ב-1908.", "international", 1908),
    ],
    "03-23": [
        ("פטירתו של סטנדל", "הסופר הצרפתי סטנדל, מחבר 'האדום והשחור' ו'מנזר פארמה', נפטר ב-1842.", "international", 1842),
    ],
    "03-24": [
        ("פטירתו של ז׳ול ורן", "סופר המדע הבדיוני הצרפתי ז׳ול ורן נפטר ב-1905 באמיין.", "international", 1905),
    ],
    "03-25": [
        ("יום הולדתו של פלנרי אוקונור", "הסופרת האמריקאית פלנרי אוקונור, בעלת סגנון גותי דרומי ייחודי, נולדה ב-1925.", "international", 1925),
    ],
    "03-26": [
        ("יום הולדתו של טנסי וויליאמס", "המחזאי האמריקאי טנסי וויליאמס, מחבר 'חשמלית ושמה תשוקה' ו'חתול על גג רותח', נולד ב-1911.", "international", 1911),
    ],
    "03-27": [
        ("פטירתה של וירג׳יניה וולף", "הסופרת הבריטית וירג׳יניה וולף, מחלוצות הספרות המודרניסטית, נפטרה ב-1941.", "international", 1941),
    ],
    "03-28": [
        ("יום הולדתו של מקסים גורקי", "הסופר הרוסי מקסים גורקי, מחבר 'האם' ומייסד הריאליזם הסוציאליסטי, נולד ב-1868.", "international", 1868),
    ],
    "03-29": [
        ("יום הולדתה של דבורה בארון", "הסופרת העברית דבורה בארון נולדה ב-1887 בליטא. נחשבת לסופרת העברית הראשונה ויצירתה עוסקת בחיי העיירה.", "israeli", 1887),
    ],
    "03-30": [
        ("יום הולדתו של פול ורלן", "המשורר הצרפתי פול ורלן, מגדולי המשוררים הסמליסטיים, נולד ב-1844.", "international", 1844),
    ],
    "03-31": [
        ("יום הולדתו של אוקטביו פאס", "המשורר המקסיקני אוקטביו פאס, זוכה פרס נובל לספרות (1990), נולד ב-1914.", "international", 1914),
    ],
}

# ═══════════════════════════════════════════════════════════════
#  POST SUGGESTION TEMPLATES
# ═══════════════════════════════════════════════════════════════

def generate_suggestions(events, mm_dd):
    """Generate post suggestions based on available events."""
    suggestions = []
    month = int(mm_dd.split("-")[0])

    # Suggestion from Israeli events
    israeli_events = [e for e in events if e[2] == "israeli"]
    for ev in israeli_events[:1]:
        suggestions.append({
            "title": f"לציון {ev[0]}",
            "description": f"פוסט לכבוד {ev[0]}. {ev[1]} ניתן לשתף ציטוט מיצירותיו/ה ולהזמין את הקוראים להגיב עם היצירה האהובה עליהם.",
            "hashtags": ["#ספריותתלאביב", "#ספרות_עברית", "#היום_בהיסטוריה"]
        })

    # Suggestion from international events
    intl_events = [e for e in events if e[2] == "international"]
    for ev in intl_events[:1]:
        suggestions.append({
            "title": f"המלצת קריאה — {ev[0].replace('יום הולדתו של ', '').replace('יום הולדתה של ', '').replace('פטירתו של ', '').replace('פטירתה של ', '')}",
            "description": f"{ev[1]} הזמנה להכיר את יצירותיו/ה בתרגום עברי. האם קראתם? מה דעתכם?",
            "hashtags": ["#ספריותתלאביב", "#המלצת_קריאה", "#ספרות_עולמית"]
        })

    # Reading challenge / quiz suggestion
    if len(events) >= 2:
        suggestions.append({
            "title": "חידון ספרותי יומי",
            "description": f"חידון קצר: 'מי כתב את השורה הזו?' — בחרו שורה מפורסמת מאחד הסופרים שנולדו/נפטרו היום ותנו לקהל לנחש. מעודד אינטראקציה ומעורבות.",
            "hashtags": ["#ספריותתלאביב", "#חידון_ספרותי", "#בואו_לנחש"]
        })

    # Seasonal / general suggestion
    seasonal = get_seasonal_suggestion(month, mm_dd)
    if seasonal:
        suggestions.append(seasonal)

    # Library visit suggestion
    suggestions.append({
        "title": "הספר שמחכה לכם על המדף",
        "description": "פוסט עם תמונה של מדף ספרים מסניף הספרייה — 'באו לגלות מה מחכה לכם היום'. הזמנה חמה לביקור בספרייה הקרובה.",
        "hashtags": ["#ספריותתלאביב", "#בואו_לספרייה", "#קריאה_מהנה"]
    })

    return suggestions[:5]


def get_seasonal_suggestion(month, mm_dd):
    """Return a seasonal suggestion based on the month."""
    seasonal_map = {
        1: {"title": "שנה חדשה, ספר חדש", "description": "המלצות לספרים לפתיחת השנה. אילו ספרים אתם מתכננים לקרוא השנה? שתפו את רשימת הקריאה שלכם!", "hashtags": ["#ספריותתלאביב", "#קריאה_2026", "#שנה_חדשה"]},
        2: {"title": "חודש האהבה בספרייה", "description": "סיפורי אהבה מהספרות העברית והעולמית: מ'מיכאל שלי' של עמוס עוז ועד 'אהבה בימי כולרה' של מארקס. מה סיפור האהבה הספרותי האהוב עליכם?", "hashtags": ["#ספריותתלאביב", "#אהבה_בספרות", "#סיפורי_אהבה"]},
        3: {"title": "אביב, פרחים וספרים", "description": "האביב הגיע! המלצות לקריאת אביב — ספרים קלילים, שירה, וספרי טבע. בואו לקרוא בגינת הספרייה.", "hashtags": ["#ספריותתלאביב", "#קריאת_אביב", "#ספרים_וטבע"]},
        4: {"title": "חג החירות וחירות הקריאה", "description": "לכבוד פסח — ספרים על חירות, שחרור ומסעות. מההגדה ועד ספרות עכשווית שעוסקת בנושאי חירות.", "hashtags": ["#ספריותתלאביב", "#פסח", "#חירות"]},
        5: {"title": "ספרים ישראליים לחודש מאי", "description": "חודש העצמאות — המלצות על ספרות ישראלית חדשה. מה הספר הישראלי האחרון שקראתם?", "hashtags": ["#ספריותתלאביב", "#ספרות_ישראלית", "#יום_העצמאות"]},
        6: {"title": "קריאת קיץ — ההכנות מתחילות", "description": "הקיץ מתקרב! בואו להכין את רשימת הקריאה. המלצות לספרים מושלמים לחוף הים ולחופשה.", "hashtags": ["#ספריותתלאביב", "#קריאת_קיץ", "#חופשה_עם_ספר"]},
        7: {"title": "ספר בים, ספר בצל", "description": "עצות לקריאת קיץ — ספרים קלים לחוף, מותחנים לימי החופש, וספרי הרפתקאות לילדים ונוער.", "hashtags": ["#ספריותתלאביב", "#קיץ_ישראלי", "#קריאה_בחופש"]},
        8: {"title": "סוף הקיץ — ספרים לסיום מושלם", "description": "לפני שהקיץ נגמר — ספר אחרון של החופש. מה הספר שהכי נהניתם ממנו הקיץ הזה?", "hashtags": ["#ספריותתלאביב", "#סוף_הקיץ", "#שיתוף_קריאה"]},
        9: {"title": "שנה טובה — שנת קריאה פורייה", "description": "לקראת השנה החדשה — ספרים על התחלות חדשות, חשבון נפש ותקווה. מה תרצו לקרוא בשנה הבאה?", "hashtags": ["#ספריותתלאביב", "#שנה_טובה", "#ראש_השנה"]},
        10: {"title": "סתיו וספרים — צמד מושלם", "description": "ימי הסתיו מזמינים קריאה. המלצות לספרים עם כוס תה חמה — ספרות עברית ובינלאומית.", "hashtags": ["#ספריותתלאביב", "#קריאת_סתיו", "#ספר_וכוס_תה"]},
        11: {"title": "חודש הספר הישראלי", "description": "שבוע הספר העברי — הזדמנות להכיר סופרים ישראליים חדשים ולתמוך בספרות המקומית.", "hashtags": ["#ספריותתלאביב", "#שבוע_הספר", "#ספרות_ישראלית"]},
        12: {"title": "סיכום שנת קריאה", "description": "מה הספר הכי טוב שקראתם השנה? שתפו את ההמלצות שלכם ובואו ליצור רשימת 'הטובים ביותר' של הקהילה.", "hashtags": ["#ספריותתלאביב", "#סיכום_שנתי", "#הספר_של_השנה"]},
    }
    return seasonal_map.get(month)


def generate_content(mm_dd):
    """Generate full content JSON for a given MM-DD date."""
    year = datetime.now().year
    full_date = f"{year}-{mm_dd}"

    events_raw = EVENTS.get(mm_dd, [])

    literary_events = []
    for title, desc, etype, eyear in events_raw:
        event = {
            "title": title,
            "description": desc,
            "type": etype,
        }
        if eyear and eyear != 0:
            event["year"] = eyear
        literary_events.append(event)

    post_suggestions = generate_suggestions(events_raw, mm_dd)
    hebrew_date = get_approximate_hebrew_date(mm_dd)

    data = {
        "date": full_date,
        "hebrew_date": hebrew_date,
        "literary_events": literary_events,
        "post_suggestions": post_suggestions,
    }

    return data


def main():
    if len(sys.argv) > 1:
        target = sys.argv[1]
    else:
        target = date.today().strftime("%m-%d")

    os.makedirs(CONTENT_DIR, exist_ok=True)

    data = generate_content(target)
    output_file = os.path.join(CONTENT_DIR, f"{target}.json")

    with open(output_file, "w", encoding="utf-8") as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    print(f"Content saved to {output_file}")

    if not data["literary_events"]:
        print(f"Warning: No literary events found for {target}. Consider adding events to the database.")


if __name__ == "__main__":
    main()
